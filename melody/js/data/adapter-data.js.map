{"version":3,"file":"adapter-data.js","sources":["game-data.js","adapter-data.js"],"sourcesContent":["export const TIMER = 300; // 5 min\n\nexport const GAME = Object.freeze({\n  lives: 2,\n  currentTimer: TIMER,\n  score: 0,\n  currentLevel: 0,\n  nextLevel: 1\n});\n\nexport const QuestionType = {\n  GENRE: `genre`,\n  ARTIST: `artist`\n};\n\nexport const ResultGame = {\n  WIN: `win`,\n  NOLIVES: `noLives`,\n  TIMEOUT: `timeout`\n};\n\nconst Point = {\n  CORRECT_ANSWER: 1,\n  CORRECT_FAST_ANSWER: 2,\n  LIVE: 2\n};\n\nexport const calculateScore = (answers, lives) => {\n  const trueAnswers = answers.filter((item) => item.result !== false);\n  if (answers.length !== 10 || trueAnswers.length < 8) {\n    return -1;\n  }\n\n  const fastAnswers = trueAnswers.filter((item) => item.timer <= 30);\n  const pointAnswers = ((trueAnswers.length - fastAnswers.length) * Point.CORRECT_ANSWER) + (fastAnswers.length * Point.CORRECT_FAST_ANSWER);\n  const pointLives = (GAME.lives > lives) ? (GAME.lives - lives) * Point.LIVE : 0;\n\n  return pointAnswers - pointLives;\n};\n\nexport const calculateResult = (results, currentGame) => {\n  if (currentGame.timer.time <= 0) {\n    return `Время вышло! Вы не успели отгадать все мелодии`;\n  }\n\n  if (currentGame.lives < 0) {\n    return `У вас закончились все попытки. Ничего, повезёт в следующий раз!`;\n  }\n\n  // добавим результат игры в массив\n  results.push(currentGame.score);\n  const sortResults = results.sort((a, b) => b - a);\n  const place = sortResults.indexOf(currentGame.score) + 1; // место которое занял игрок\n  const totalGamers = sortResults.length;\n  const winPercent = ((totalGamers - place) / totalGamers * 100).toFixed(0);\n\n  return `Вы заняли ${place} место из ${sortResults.length}. Это лучше чем у ${winPercent}% игроков`;\n};\n\nexport const createTimer = (time) => {\n  if (typeof time === `undefined`) {\n    throw new Error(`Не указан аргумент`);\n  }\n\n  if (typeof time !== `number`) {\n    throw new Error(`Не верный тип данных, аргументом функции может быть только число`);\n  }\n\n  return {\n    time,\n    tick() {\n      if (this.time !== 0) {\n        this.time = this.time - 1;\n      }\n      this._timeout(this.time);\n    },\n\n    _timeout(currentTime) {\n      if (currentTime === 0) {\n        this.state = `timeout`;\n      }\n    }\n  };\n};\n\nexport const convertText = (number, word, one, many, multi) => {\n  const checkNumber = (num) => {\n    return (num > 21) ? +(num.toString()[1]) : num;\n  };\n\n  number = checkNumber(number);\n  if (number === 1) {\n    return word + one;\n  }\n\n  if (number > 1 && number < 5) {\n    return word + many;\n  }\n  return (number > 1 && number < 5) ? word + many : word + multi;\n};\n\nexport const showTimeResult = (time) => {\n  const {min, sec} = time;\n\n  const minutesText = convertText(+min, `минут`, `у`, `ы`, ``);\n  const secondsText = convertText(+sec, `секунд`, `у`, `ы`, ``);\n  const seconds = (sec[0] === `0`) ? sec[1] : sec;\n  return `${min} ${minutesText} и ${seconds} ${secondsText}`;\n};\n\nexport const timerConverToMinAndSec = (timer) => {\n  const minutes = Math.floor(timer / 60);\n  const seconds = ((timer % 60) / 1).toFixed(0);\n  const convertSeconds = (seconds < 10) ? `0${seconds}` : seconds;\n\n  return {\n    min: minutes.toString(),\n    sec: convertSeconds\n  };\n};\n\nexport const getRadius = (relation, radius) => {\n  const stroke = +(2 * Math.PI * radius).toFixed();\n  const offset = +((1 - relation) * stroke).toFixed();\n  return {stroke, offset};\n};\n","import {QuestionType} from './game-data';\n\nconst getAnswersArtist = (data, item) => {\n  item.answers.forEach((answer) => {\n    const adaptAnswer = {\n      artist: answer.title,\n      image: answer.image.url,\n      name: answer.title,\n      src: item.src\n    };\n\n    if (answer.isCorrect) {\n      adaptAnswer.result = () => true;\n      data.correct.push(adaptAnswer);\n    } else {\n      adaptAnswer.result = () => false;\n    }\n\n    data.answers.push(adaptAnswer);\n  });\n};\n\nconst getGenreArtist = (data, item) => {\n  item.answers.forEach((answer) => {\n    const adaptAnswer = {\n      src: answer.src,\n      genre: answer.genre\n    };\n\n    if (answer.genre === item.genre) {\n      adaptAnswer.result = () => true;\n      data.correct.push(adaptAnswer);\n    } else {\n      adaptAnswer.result = () => false;\n    }\n\n    data.answers.push(adaptAnswer);\n  });\n};\n\nexport const adapterData = (serverData) => {\n  const adaptData = [];\n  serverData.forEach((item) => {\n    const itemData = {\n      gameType: item.type,\n      title: item.question,\n      answers: [],\n      correct: []\n    };\n\n    if (item.type === QuestionType.ARTIST) {\n      getAnswersArtist(itemData, item);\n    }\n\n    if (item.type === QuestionType.GENRE) {\n      getGenreArtist(itemData, item);\n    }\n\n    adaptData.push(itemData);\n  });\n\n  return adaptData;\n};\n"],"names":[],"mappings":";;;AAAO,MAAM,KAAK,GAAG,GAAG,CAAC;;AAEzB,AAAO,MAAM,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC;EAChC,KAAK,EAAE,CAAC;EACR,YAAY,EAAE,KAAK;EACnB,KAAK,EAAE,CAAC;EACR,YAAY,EAAE,CAAC;EACf,SAAS,EAAE,CAAC;CACb,CAAC,CAAC;;AAEH,AAAO,MAAM,YAAY,GAAG;EAC1B,KAAK,EAAE,CAAC,KAAK,CAAC;EACd,MAAM,EAAE,CAAC,MAAM,CAAC;CACjB,CAAC;;ACXF,MAAM,gBAAgB,GAAG,CAAC,IAAI,EAAE,IAAI,KAAK;EACvC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK;IAC/B,MAAM,WAAW,GAAG;MAClB,MAAM,EAAE,MAAM,CAAC,KAAK;MACpB,KAAK,EAAE,MAAM,CAAC,KAAK,CAAC,GAAG;MACvB,IAAI,EAAE,MAAM,CAAC,KAAK;MAClB,GAAG,EAAE,IAAI,CAAC,GAAG;KACd,CAAC;;IAEF,IAAI,MAAM,CAAC,SAAS,EAAE;MACpB,WAAW,CAAC,MAAM,GAAG,MAAM,IAAI,CAAC;MAChC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KAChC,MAAM;MACL,WAAW,CAAC,MAAM,GAAG,MAAM,KAAK,CAAC;KAClC;;IAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;GAChC,CAAC,CAAC;CACJ,CAAC;;AAEF,MAAM,cAAc,GAAG,CAAC,IAAI,EAAE,IAAI,KAAK;EACrC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,KAAK;IAC/B,MAAM,WAAW,GAAG;MAClB,GAAG,EAAE,MAAM,CAAC,GAAG;MACf,KAAK,EAAE,MAAM,CAAC,KAAK;KACpB,CAAC;;IAEF,IAAI,MAAM,CAAC,KAAK,KAAK,IAAI,CAAC,KAAK,EAAE;MAC/B,WAAW,CAAC,MAAM,GAAG,MAAM,IAAI,CAAC;MAChC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;KAChC,MAAM;MACL,WAAW,CAAC,MAAM,GAAG,MAAM,KAAK,CAAC;KAClC;;IAED,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;GAChC,CAAC,CAAC;CACJ,CAAC;;AAEF,AAAY,MAAC,WAAW,GAAG,CAAC,UAAU,KAAK;EACzC,MAAM,SAAS,GAAG,EAAE,CAAC;EACrB,UAAU,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;IAC3B,MAAM,QAAQ,GAAG;MACf,QAAQ,EAAE,IAAI,CAAC,IAAI;MACnB,KAAK,EAAE,IAAI,CAAC,QAAQ;MACpB,OAAO,EAAE,EAAE;MACX,OAAO,EAAE,EAAE;KACZ,CAAC;;IAEF,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,CAAC,MAAM,EAAE;MACrC,gBAAgB,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAClC;;IAED,IAAI,IAAI,CAAC,IAAI,KAAK,YAAY,CAAC,KAAK,EAAE;MACpC,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;KAChC;;IAED,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;GAC1B,CAAC,CAAC;;EAEH,OAAO,SAAS,CAAC;CAClB;;;;;;;;;;"}